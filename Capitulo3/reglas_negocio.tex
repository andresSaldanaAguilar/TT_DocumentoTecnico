\section{Reglas de negocio}
En la presente sección, se muestran las reglas de negocio del sistema.
\begin{enumerate}[label=RN\arabic*.]
    \item \label{RN1}
		\begin{description}
			\item[Nombre] RN1-Obtención de muestras del sistema fotovoltaico en tiempo real.
			\item[Tipo] Regla de operación.
			\item[Objetivo] La obtención de mediciones del sistema fotovoltaico se realizará en tiempo real.
			\item[Descripción] La obtención de mediciones del sistema fotovoltaico dependerá del dispositivo de monitoreo empleado, en este caso, se trata del MCP39F521, y está determinada por la frecuencia de reloj de IIC de 400 Khz, sin embargo nuestro sistema trabajará a una frecuencia de 1 segundo.
    		\end{description}
    		
\item \label{RN2}
	\begin{description}
		\item[Nombre] RN2-Envío de muestras del sistema fotovoltaico en tiempo real.
		\item[Tipo] Regla de operación.
		\item[Objetivo] Establecer el tiempo y frecuencia de envío de mediciones del microcontrolador por medio del módulo Wi-Fi.
		\item[Descripción] El envío de muestras del microcontrolador por medio del módulo Wi-Fi dependerá de la velocidad de transmisión UART entre el microcontrolador y el módulo, que es de 115200 baudios. Un baudio es el número de unidades de información transmitidas por segundo ,que dependiendo de la configuración puede estar entre los 9600 a 11520 Bytes/Segundo, la frecuencia de envío de muestras hacia el servidor será de 1 segundo, obteniendo así una resolución de la unidad de generación de energía en Kilowatt Segundo para después ser convertida a Kilowatt Hora.
		\end{description}	
		
    \item \label{RN3}
		\begin{description}
			\item[Nombre] RN3-Creación de alertas cuando se detecta que el sistema fotovoltaico dejó de producir energía.
			\item[Tipo] Regla de estímulo y respuesta.
			\item[Objetivo] Crear alertas que le informen al usuario el momento exacto en que el sistema fotovoltaico ha dejado de producir energía.
			\item[Descripción] La alerta será creada y enviada como notificación al usuario de forma inmediata si y sólo si en el proceso de monitoreo se ha detectado que la medición de energía producida es de 0 volts, si se pierde conexión con el microcontrolador o servidor.  
    		\end{description}
    		
\item \label{RN4}
		\begin{description}
			\item[Nombre] RN4-Calcular producción de energía historicamente.
			\item[Tipo] Derivadora.
			\item[Objetivo] Calcular la producción de energía del intervalo de tiempo requerido.
			\item[Descripción] El informe de históricos al usuario mediante la aplicación móvil puede ser la producción de la energía semanal, mensual o bimestral, este se calcula sumando la producción de Watts por Segundo del muestreo definido en la Regla de Negocio \ref{RN2} en los periodos ya mencionados y se realizará el reporte de los siguientes periodos:
			\\ Semanalmente: 
			\begin{itemize}
				\item La producción diaria de una semana, es decir, siete valores de producción.
			\end{itemize}
			\\ Mensualmente: 
			\begin{itemize}
				\item La producción de cada semana que constituye un mes.
			\end{itemize}
			\\ Bimestralmente: 
			\begin{itemize}
				\item La producción en el periodo de tiempo comprendido del 1 de Enero al 28 o 29 de Febrero (dependiendo de si el año es bisiesto)
				\item La producción en el periodo de tiempo comprendido del 1 de Marzo al 30 de Abril
				\item La producción en el periodo de tiempo comprendido del 1 de Mayo al 30 de Junio
				\item La producción en el periodo de tiempo comprendido del 1 de Julio al 31 de Agosto
				\item La producción en el periodo de tiempo comprendido del 1 de Septiembre al 31 de Octubre
				\item La producción en el periodo de tiempo comprendido del 1 de Noviembre al 31 de Diciembre
			\end{itemize}
		\end{description}

\item \label{RN5}
		\begin{description}
			\item[Nombre] RN5-Calcular promedio de energía sensada diariamente.
			\item[Tipo] Derivadora.
			\item[Objetivo] Calcular promedio de energía sensada diariamente
			\item[Descripción] El promedio es igual a la suma de las 288 muestras tomadas  diariamente como lo especifica la regla de negocio \ref{RN6} entre este mismo número.	\end{description}

\item \label{RN6}
		\begin{description}
			\item[Nombre] RN6-Periodo de toma de muestras.
			\item[Tipo] Operacional.
			\item[Objetivo] Establecer el periodo de tiempo en el que las muestras serán tomadas.
			\item[Descripción] Las muestras comenzarán a tomarse a partir de las 0:00 hrs hasta las 23:59 c en la frecuencia indicada en la \ref{RN2}, adicionalmente se guardara cada 5 minutos el valor de la energía actual para la graficacion en tiempo real, dando un total de 288 muestras diarias para la gráfica en tiempo real		\end{description}
		
%Checar tipo
\item \label{RN7}
		\begin{description}
			\item[Nombre] RN7-Estándar de comunicación.
			\item[Tipo] Derivación.
			\item[Objetivo] Establecer el estándar de comunicación entre microcontrolador-servidor y servidor-aplicación de usuario.
			\item[Descripción] El estándar de comunicación entre el servidor y la aplicación de usuario sera por medio de TCP, y para la comunicación entre microcontrolador y servidor será por medio de UDP, ambos proporcionan la base para los productos con redes inalámbricas que hacen uso de la marca Wi-Fi.
		\end{description}
		
%Checar tipo		
\item \label{RN8}
		\begin{description}
			\item[Nombre] RN8-Patrón de intercambio de mensajes.
			\item[Tipo] Derivación.
			\item[Objetivo] Establecer el patrón de intercambio de información entre módulos.
			\item[Descripción] El patrón de intercambio de información a utilizar entre módulos será petición-respuesta para el caso del protocolo TCP, para UDP solamente se hace el envío del paquete.
		\end{description}
		
%Después definir los datos exactos? o en req técnicos		
\item \label{RN9}
		\begin{description}
			\item[Nombre] RN9-Almacenamiento de datos de monitoreo.
			\item[Tipo] Regla de operación.
			\item[Objetivo] Establecer el método de almacenamiento de la información.
			\item[Descripción] El almacenamiento en el servidor está limitado por la memoria externa con capacidad desde 8GB de espacio que le es agregada, por lo que usaremos una herramienta que trabaja con una cantidad de datos fija, sobreescribiendo la información cuando terminan e inician nuevamente los periodos definidos en la Regla de Negocio \ref{RN4}		\end{description}

%Preguntar request-reply si es RN8?

%Definí como tipo, preguntar si otra regla debemos poner el formato (bien conformado con un xsd)?
%Checar si será XML o JSON
\item \label{RN10}
		\begin{description}
			\item[Nombre] RN10-Formato de datos almacenados.
			\item[Tipo] Regla de restricción.
			\item[Objetivo] Definir el formato en que serán almacenados los datos sensados.
			\item[Descripción] El formato en que serán almacenados los datos sensados está definido por un archivo con extensión JSON, estos archivos estarán contenidos dentro de la carpeta del numero de sensor esclavo correspondiente y a su vez dentro de la carpeta con el numero de serie del microcontrolador correspondiente, que esta identificado por dos letras alfabéticas, por ejemplo, AC.		\end{description}
		
\item \label{RN11}
		\begin{description}
			\item[Nombre] RN11-Formato de datos de respuesta para la aplicación de usuario.
			\item[Tipo] Regla de operación.
			\item[Objetivo] Definir el formato de los datos en que se enviarán las respuestas a las peticiones del cliente.
			\item[Descripción] El formato de los datos que se darán como respuesta a la aplicación será en formato JSON, donde se tiene que especificar si se va a requerir información del servidor o datos almacenados, de ser así, se debe especificar de que archivo(s), microcontrolador y sensor se pide la información separando con saltos de linea estas especificaciones		\end{description}
		
\item \label{RN12}
		\begin{description}
			\item[Nombre] RN12-Umbrales de generación
			\item[Tipo] Regla de operación.
			\item[Objetivo] Definir los umbrales de generación de energía de acuerdo a la generación en tiempo real y los intervalos definidos 
			\item[Descripción] Los umbrales se dividirán  en tres para todos los casos, generación óptima, intermedia y baja.
			El criterio a comparar será el valor de generación obtenido contra el valor de generación esperado por un panel solar, que es de 250 Watts/Hora, donde el porcentaje obtenido por la relación se clasificará de la siguiente manera:
			\begin{itemize}
			    \item 80\% - 100\% Generación Óptima, representado con el color verde.
			    \item 50\% - 79\% Generación Intermedia, representado con el color amarillo.
			    \item 0\% - 49\% Generación Baja, representado con el color rojo.
			\end{itemize}
		\end{description}
	
\item \label{RN13}
		\begin{description}
			\item[Nombre] RN13-Número de registros de notificaciones.
			\item[Tipo] Regla de restricción.
			\item[Objetivo] Definir la cantidad máxima de registros de notificaciones a conservar en la aplicación móvil.
			\item[Descripción] El número máximo de registros de notificaciones que se permitirán conservar en la aplicación móvil tiene que ser menor o igual a 30 notificaciones. El criterio para conservar las notificaciones dependerá únicamente del tiempo de llegada, es decir, se conservarán las notificaciones más recientes.   
		\end{description}
		
\item \label{RN14}
		\begin{description}
			\item[Nombre] RN14-Formato de fecha de notificaciones.
			\item[Tipo] Regla de estructura.
			\item[Objetivo] Definir el formato de fecha de las notificaciones para la aplicación móvil.
			\item[Descripción] El formato de fecha en que serán almacenadas las notificaciones del sistema en la aplicación móvil es: dd/mm/aa.
			Donde:
			\begin{itemize}
		 		\item dd = Corresponde al número de día del mes.
		 		\item mm = Corresponde al número de mes del año.
		 		\item aa = Corresponde al año
		    \end{itemize}
		\end{description}
		
\item \label{RN15}
		\begin{description}
			\item[Nombre] RN15-Formato de hora de notificaciones.
			\item[Tipo] Regla de estructura.
			\item[Objetivo] Definir el formato de hora de las notificaciones para la aplicación móvil.
			\item[Descripción] El formato de hora en que serán almacenadas las notificaciones del sistema en la aplicación móvil es: hh:mm.
			Donde:
			\begin{itemize}
		 		\item hh = Corresponde a la hora del día en formato de 24 horas.
		 		\item mm = Corresponde al minuto de la hora.
		    \end{itemize}
		\end{description}
%Estipular cuantas muestras se tomaran por dia y bimestralmente y si se deshecharán,
%Tipo de archivo en el que se almacenarán los datos

\item \label{RN16}
		\begin{description}
			\item[Nombre] RN16-Formato de IP válido.
			\item[Tipo] Regla de estructura.
			\item[Objetivo] Definir el formato IP válido para poder hacer la conexión con el servidor.
			\item[Descripción] El formato de IP válido será N.N.N.N
			Donde:
			\begin{itemize}
		 		\item N = numero entero menor a 255 y mayor o igual a 0
		    \end{itemize}
		\end{description}

\end{enumerate}